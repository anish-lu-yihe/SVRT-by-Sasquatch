from pylab import *
import math
import numpy as np
import numpy.numarray as na
import random
from scipy.stats import sem

random_samples_6 = [(-146815.050000,-146297.207000),
                    (-191199.638000,-189830.667000),
                    (-109792.163000,-111531.948000),
                    (-175461.928000,-171591.675000),
                    (-125449.886000,-127202.266000),
                    (-163904.353000,-166883.865000),
                    (-168943.628000,-169397.129000),
                    (-206273.895000,-208733.568000),
                    (-155966.095000,-158906.201000),
                    (-98512.398000,-100372.281000),
                    (-175461.928000,-171591.675000),
                    (-141799.577000,-144813.740000),
                    (-160914.123000,-160617.598000),
                    (-125449.886000,-127202.266000),
                    (-285184.121000,-284281.137000),
                    (-182630.355000,-177551.636000),
                    (-164009.614000,-162646.799000),
                    (-121556.447000,-118624.185000),
                    (-221062.752000,-220277.987000),
                    (-116543.917000,-118268.997000),
                    (-163904.353000,-166883.865000),
                    (-98512.398000,-100372.281000),
                    (-104152.243000,-105952.075000),
                    (-159542.275000,-161283.165000),
                    (-172791.422000,-171700.387000),
                    (-141799.577000,-144813.740000)]

random_samples_2 = [(-38506.967000,-40470.292000),
                    (-39648.416000,-42136.766000),
                    (-43107.917000,-46151.455000),
                    (-38708.308000,-41013.167000),
                    (-38708.308000,-41013.167000),
                    (-44555.765000,-45983.080000),
                    (-32795.489000,-34157.801000),
                    (-59811.217000,-60452.142000),
                    (-43107.917000,-46151.455000),
                    (-46308.075000,-46043.229000),
                    (-43107.917000,-46151.455000),
                    (-43107.917000,-46151.455000),
                    (-50837.003000,-51887.150000),
                    (-74778.917000,-75389.831000),
                    (-46824.728000,-49337.911000),
                    (-30834.149000,-32216.535000),
                    (-39648.416000,-42136.766000),
                    (-38506.967000,-40470.292000),
                    (-59811.217000,-60452.142000),
                    (-53458.262000,-54559.892000),
                    (-50530.971000,-53343.299000),
                    (-46308.075000,-46043.229000),
                    (-50837.003000,-51887.150000),
                    (-35747.188000,-37923.556000),
                    (-49085.815000,-50037.692000),
                    (-43107.917000,-46151.455000),
                    (-56188.468000,-56302.776000),
                    (-32795.489000,-34157.801000),
                    (-41056.175000,-42250.149000),
                    (-42915.912000,-46065.31400)]

random_samples_4 = [(-30834.149000,-32216.535000),
                    (-29940.428000,-32004.778000),
                    (-27768.454000,-28016.993000),
                    (-34929.758000,-36473.432000),
                    (-41008.179000,-41943.677000),
                    (-33399.929000,-36019.467000),
                    (-31855.887000,-34334.433000),
                    (-28481.452000,-29168.385000),
                    (-42281.182000,-43599.076000),
                    (-30834.149000,-32216.535000),
                    (-30834.149000,-32216.535000),
                    (-30834.149000,-32216.535000),
                    (-20253.427000,-20183.438000),
                    (-44467.275000,-45889.356000),
                    (-30834.149000,-32216.535000),
                    (-38506.967000,-40470.292000),
                    (-27374.648000,-28201.846000),
                    (-38506.967000,-40470.292000),
                    (-43239.613000,-44648.933000),
                    (-26233.199000,-26535.372000),
                    (-27374.648000,-28201.846000),
                    (-43240.569000,-44697.548000),
                    (-30834.149000,-32216.535000),
                    (-30834.149000,-32216.535000),
                    (-38290.694000,-39271.050000),
                    (-25225.136000,-25228.950000),
                    (-27374.648000,-28201.846000),
                    (-33493.432000,-35633.042000),
                    (-31140.557000,-32087.173000),
                    (-43107.917000,-46151.45500)]

def simulate(random_samples,iterations):
    l = []
    for n in range(1000):
        samples = random.sample(random_samples,iterations)
        model = max(samples)
        l.append(model[1])
    return np.average(l),sem(np.array(l))

def simulate_curve(random_samples,c):
    x = np.arange(1,1+len(random_samples))
    y = []
    best = (-float('inf'),-float('inf'))
    for training,test in random.sample(random_samples,len(random_samples)):
        if training > best[0]:
            best = (training,test)
        y.append(best[1])
    plot(x,np.array(y),'--',color = c,alpha = 0.2)
    
x = np.arange(1,31)
y = [simulate(random_samples_4,i) for i in range(1,31) ]
v = [j[1] for j in y ]
y = np.array([j[0] for j  in y ])

figure()
#errorbar(x,y,yerr = v)

y = [simulate(random_samples_2,i) for i in range(1,31) ]
v = [j[1] for j in y ]
y = np.array([j[0] for j  in y ])
#errorbar(x,y,yerr = v,color = 'r')


#for j in range(100): simulate_curve(random_samples_4,'r')

#for j in range(100): simulate_curve(random_samples_2,'b')
for j in range(100): simulate_curve(random_samples_6,'b')
ylabel('Held-out Log Likelihood')
xlabel('RANSAC iterations')
show()
savefig('random.png')
